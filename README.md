# Rate Limiter

---
Rate Limiterλ” Java κΈ°λ° μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ„ν• ν™•μ¥ κ°€λ¥ν• μ²λ¦¬μ¨ μ ν• λΌμ΄λΈλ¬λ¦¬μ…λ‹λ‹¤. λ³Έ λΌμ΄λΈλ¬λ¦¬λ” μ‹μ¤ν… μ•μ •μ„±κ³Ό μ„±λ¥ λ³΄μ¥μ„ μ„ν•΄ μ”μ²­ μ²λ¦¬μ¨μ„ μ •λ°€ν•κ² μ μ–΄ν•©λ‹λ‹¤. λ³Έ λΌμ΄λΈλ¬λ¦¬λ” API λ‚¨μ© λ°©μ§€, μ„λ²„ λ¶€ν• λ¶„μ‚°, μμ› ν¨μ¨μ  κ΄€λ¦¬λΌλ” ν•µμ‹¬ λ©ν‘λ¥Ό λ‹¬μ„±ν•κΈ° μ„ν•΄ λ‹¤μ–‘ν• μ•κ³ λ¦¬μ¦, μ μ—°ν• μ¤ν† λ¦¬μ§€ μ†”λ£¨μ…, κ·Έλ¦¬κ³  Spring λ° HTTP ν΄λΌμ΄μ–ΈνΈ μ—°λ™ κΈ°λ¥μ„ μ κ³µν•¨μΌλ΅μ¨ κ°λ°μκ°€ λ μ΄νΈ λ¦¬λ―Έν…μ„ ν¨κ³Όμ μΌλ΅ κµ¬ν„ν•κ³  κ΄€λ¦¬ν•  μ μλ„λ΅ μ§€μ›ν•©λ‹λ‹¤.

---
## β¨ μ£Όμ” κΈ°λ¥

### 1. λ‹¤μ–‘ν• μ•κ³ λ¦¬μ¦ μ§€μ›
κ³ μ • μλ„μ°, μ¬λΌμ΄λ”© μλ„μ°, ν† ν° λ²„ν‚·, λ¦¬ν‚¤ λ²„ν‚· λ“± μ—…κ³„ ν‘μ¤€ λ μ΄νΈ λ¦¬λ―Έν… μ•κ³ λ¦¬μ¦μ„ κµ¬ν„ν•μ—¬ μ κ³µν•©λ‹λ‹¤.

### 2. μ μ—°ν• μ¤ν† λ¦¬μ§€
μΈλ©”λ¨λ¦¬ μ¤ν† λ¦¬μ§€(InMemoryRateLimitStorage)λ¥Ό κΈ°λ³Έ μ κ³µν•μ—¬ μ‹ μ†ν• κ°λ° ν™κ²½ κµ¬μ¶• λ° λ‹¨μΌ μΈμ¤ν„΄μ¤ μ• ν”λ¦¬μΌ€μ΄μ…μ— μ ν•©ν•©λ‹λ‹¤. ν–¥ν›„ λ¶„μ‚° ν™κ²½μ„ μ„ν• Redis μ¤ν† λ¦¬μ§€(RedisRateLimitStorage)λ¥Ό μ§€μ›ν•μ—¬ μ„λ²„ μΈμ¤ν„΄μ¤ κ°„ μΌκ΄€λ μ ν• μ •μ±… μ μ§€λ¥Ό κ°€λ¥ν•κ² ν•  μμ •μ…λ‹λ‹¤. μ»¤μ¤ν…€ μ¤ν† λ¦¬μ§€ κµ¬ν„ λν• κ°€λ¥ν•©λ‹λ‹¤.

### 3. κ°„νΈν• ν†µν•©
Spring WebMVC (ServletFilter), Spring WebFlux (WebFluxFilter), OpenFeign ν΄λΌμ΄μ–ΈνΈ (RateLimitFeignInterceptor) λ“± λ‹¤μ–‘ν• HTTP μ”μ²­ μ²λ¦¬ ν”„λ μ„μ›ν¬μ™€μ μ›ν™ν• ν†µν•©μ„ μ§€μ›ν•©λ‹λ‹¤. RateLimitKeyResolverλ” HTTP μ”μ²­μΌλ΅λ¶€ν„° κ³ μ  ν‚¤λ¥Ό μλ™ μ¶”μ¶ν•μ—¬ ν†µν•© νΈμμ„±μ„ λ†’μ…λ‹λ‹¤.

### 4. Spring Boot νΈν™μ„±
Spring Bootμ— μµμ ν™”λ λ¨λ“(rate-limiter-spring-starter)μ€ @RateLimit μ–΄λ…Έν…μ΄μ…κ³Ό Spring AOPλ¥Ό ν™μ©ν•μ—¬ λ©”μ„λ“ λ‹¨μ„ λ μ΄νΈ λ¦¬λ―Έν…μ„ μ„ μ–Έμ μΌλ΅ μ μ©ν•©λ‹λ‹¤. μ΄λ” λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό λ μ΄νΈ λ¦¬λ―Έν… λ΅μ§μ„ λ¶„λ¦¬ν•μ—¬ μ½”λ“ κ°€λ…μ„± λ° μ μ§€λ³΄μμ„±μ„ ν–¥μƒμ‹ν‚µλ‹λ‹¤.

### 5. λ©”νΈλ¦­ λ° λ΅κΉ…
Micrometerλ¥Ό ν†µν• μƒμ„Έ λ©”νΈλ¦­ μμ§‘ λ° μ΄λ²¤νΈ λ΅κΉ… κΈ°λ¥μ„ μ κ³µν•μ—¬ μ‹μ¤ν… κ°€μ‹μ„±μ„ λ†’μ΄κ³  ν¨μ¨μ μΈ λ¨λ‹ν„°λ§μ„ μ§€μ›ν•©λ‹λ‹¤. Prometheusμ™€ κ°™μ€ λ¨λ‹ν„°λ§ μ‹μ¤ν…κ³Όμ μ—°λ™ λ° μƒμ„Έ λ΅κΉ…μ€ λ””λ²„κΉ…κ³Ό λ¬Έμ  ν•΄κ²°μ— ν•„μμ μ…λ‹λ‹¤.

### 6. ν™•μ¥μ„±
RateLimiterStorage μΈν„°νμ΄μ¤ λ° MetricsCollector μ¶”μƒν™”μ™€ κ°™μ€ μ μ—°ν• ν™•μ¥ ν¬μΈνΈλ¥Ό μ κ³µν•¨μΌλ΅μ¨, μ‚¬μ©μλ” μ»¤μ¤ν…€ μ¤ν† λ¦¬μ§€ κµ¬ν„ λλ” κΈ°μ΅΄ λ©”νΈλ¦­ μ‹μ¤ν…κ³Όμ μ›ν™ν• μ—°λ™μ„ μ‹¤ν„ν•  μ μμµλ‹λ‹¤.

---

## π“¦ λ¨λ“ κµ¬μ„±
rate-limiter ν”„λ΅μ νΈλ” λ‹¤μκ³Ό κ°™μ€ λ¨λ“λ΅ κµ¬μ„±λμ–΄ μμΌλ©°, κ° λ¨λ“μ€ λ…λ¦½μ μΈ κΈ°λ¥μ„ μν–‰ν•¨κ³Ό λ™μ‹μ— μ κΈ°μ μΌλ΅ κ²°ν•©λμ–΄ ν¬κ΄„μ μΈ λ μ΄νΈ λ¦¬λ―Έν… μ†”λ£¨μ…μ„ μ κ³µν•©λ‹λ‹¤.

```text
1. rate-limit-core
2. rate-limit-storage
3. rate-limit-algorithm
4. rate-limit-factory
5. rate-limit-http
6. rate-limit-metrics
7. rate-limit-client
8. rate-limit-spring-starter
9. rate-limit-sample-app
```


### 1. rate-limiter-core

λ³Έ λ¨λ“μ€ λ μ΄νΈ λ¦¬λ―Έν„°μ ν•µμ‹¬ μ •μμ™€ κ³µν†µ μΈν„°νμ΄μ¤λ¥Ό ν¬κ΄„ν•λ©°, λΌμ΄λΈλ¬λ¦¬μ λ¨λ“  λ μ΄νΈ λ¦¬λ―Έν… κΈ°λ¥μ— λ€ν• κ·Όκ°„μ„ μ κ³µν•©λ‹λ‹¤.


### 2. rate-limiter-storage

λ μ΄νΈ λ¦¬λ―Έν… λ°μ΄ν„°λ¥Ό μ €μ¥ν•κ³  κ΄€λ¦¬ν•κΈ° μ„ν• μ¶”μƒν™” λ° μΈλ©”λ¨λ¦¬ κµ¬ν„μ²΄λ¥Ό μ κ³µν•©λ‹λ‹¤.

### 3. rate-limiter-algorithm

λ„λ¦¬ μ‚¬μ©λλ” λ‹¤μ–‘ν• λ μ΄νΈ λ¦¬λ―Έν… μ•κ³ λ¦¬μ¦μ κµ¬ν„μ²΄λ¥Ό ν¬ν•¨ν•λ©°, κ° μ•κ³ λ¦¬μ¦μ€ RateLimiter μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•©λ‹λ‹¤.

### 4. rate-limiter-factory

λ‹¤μ–‘ν• Rate Limiting μ•κ³ λ¦¬μ¦κ³Ό μ €μ¥μ† κµ¬ν„μ²΄λ“¤μ„ μ΅°ν•©ν•μ—¬
κ°„νΈν•κ² `RateLimiter` μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•  μ μλ„λ΅ λ„μ™€μ£Όλ” μ§„μ…μ (Entry Point) λ¨λ“μ…λ‹λ‹¤.

μ΄ λ¨λ“μ„ ν†µν•΄ κ°λ°μλ” λ³µμ΅ν• μ„¤μ • μ—†μ΄λ„ ν•„μ”ν• μ•κ³ λ¦¬μ¦κ³Ό μ €μ¥μ†λ¥Ό μ—°κ²°ν•΄
μ μ—°ν•κ³  ν™•μ¥ κ°€λ¥ν• Rate Limiting κΈ°λ¥μ„ λ°”λ΅ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

### 5. rate-limiter-http

HTTP μ”μ²­ ν™κ²½κ³Όμ μ—°λ™μ„ μ„ν• μ»΄ν¬λ„νΈλ¥Ό μ κ³µν•μ—¬, μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ— λ μ΄νΈ λ¦¬λ―Έν…μ„ μ†μ‰½κ² μ μ©ν•  μ μλ„λ΅ ν•©λ‹λ‹¤.

### 6. rate-limiter-metrics

λ μ΄νΈ λ¦¬λ―Έν… ν™λ™μ— λ€ν• λ΅κΉ… λ° λ©”νΈλ¦­ κΈ°λ¥μ„ μ κ³µν•μ—¬ μ‹μ¤ν…μ κ°€μ‹μ„±μ„ λ†’μ΄κ³  ν¨μ¨μ μΈ λ¨λ‹ν„°λ§μ„ μ§€μ›ν•©λ‹λ‹¤.

### 7. rate-limiter-client

μ™Έλ¶€ API νΈμ¶ μ‹ λ μ΄νΈ λ¦¬λ―Έν…μ„ μ μ©ν•κΈ° μ„ν• λνΌ λ¨λ“μ…λ‹λ‹¤.

### 8. rate-limiter-spring-starter

Spring μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ μ–΄λ…Έν…μ΄μ…κ³Ό Spring AOPλ¥Ό ν†µν•΄ λ μ΄νΈ λ¦¬λ―Έν…μ„ μ„ μ–Έμ μΌλ΅ μ μ©ν•  μ μλ„λ΅ λ•λ” λ¨λ“μ…λ‹λ‹¤.

### 9. rate-limiter-sample-app

λ³Έ λΌμ΄λΈλ¬λ¦¬μ μ‹¤μ  μ‚¬μ© μμ‹ λ° λ°λ¨λ¥Ό ν¬ν•¨ν•λ” ν”„λ΅μ νΈλ΅, ν–¥ν›„ ν™•μ¥λ  μμ •μ…λ‹λ‹¤.

---
## π€ μ‹μ‘ν•κΈ°
rate-limiterλ¥Ό ν”„λ΅μ νΈμ— ν†µν•©ν•κ³  ν™μ©ν•λ” μ μ°¨λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.

### 1. μμ΅΄μ„± μ¶”κ°€
Maven λλ” Gradleκ³Ό κ°™μ€ λΉλ“ λ„κµ¬λ¥Ό μ‚¬μ©ν•μ—¬ ν•„μ”ν• λ¨λ“μ„ ν”„λ΅μ νΈμ μμ΅΄μ„±μΌλ΅ μ¶”κ°€ν•©λ‹λ‹¤. λ‹¤μμ€ μμ‹ μ½”λ“μ…λ‹λ‹¤.

```xml
<!-- Maven -->
<dependencies>
    <dependency>
        <groupId>com.innerCircle.ratelimiter</groupId>
        <artifactId>rate-limiter-spring-starter</artifactId>
        <version>1.0.0-SNAPSHOT</version>
    </dependency>
    <dependency>
        <groupId>com.innerCircle.ratelimiter</groupId>
        <artifactId>rate-limiter-algorithm</artifactId>
        <version>1.0.0-SNAPSHOT</version>
    </dependency>
</dependencies>
```

```gradle
// Gradle
implementation 'com.innerCircle.ratelimiter:rate-limiter-spring-starter:1.0.0-SNAPSHOT'
implementation 'com.innerCircle.ratelimiter:rate-limiter-algorithm:1.0.0-SNAPSHOT'
```

2. ### `@RateLimit` μ–΄λ…Έν…μ΄μ… ν™μ© μμ‹

Spring Boot μ• ν”λ¦¬μΌ€μ΄μ… λ‚΄μ—μ„ `@RateLimit` μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•μ—¬ νΉμ • λ©”μ„λ“μ— λ μ΄νΈ λ¦¬λ―Έν… μ •μ±…μ„ μ„ μ–Έμ μΌλ΅ μ μ©ν•  μ μμµλ‹λ‹¤.

```java

```

---
## π” μ¤ν† λ¦¬μ§€ ν™•μ¥ (ν–¥ν›„ κ³„ν)

ν„μ¬λ” `InMemoryRateLimitStorage`λ¥Ό μ κ³µν•κ³  μμΌλ‚, ν–¥ν›„ λ‹¤μ–‘ν• μ¤ν† λ¦¬μ§€ μµμ…μ„ μ¶”κ°€λ΅ μ§€μ›ν•  κ³„νμ…λ‹λ‹¤.

* **`RedisRateLimitStorage`**: (κ³„ν μ¤‘) Redis κΈ°λ°μ λ¶„μ‚° ν™κ²½μ© μ¤ν† λ¦¬μ§€ κµ¬ν„μ²΄λ΅, λ‹¤μμ μ• ν”λ¦¬μΌ€μ΄μ… μΈμ¤ν„΄μ¤ κ°„ μΌκ΄€λ μ ν•μ„ λ³΄μ¥ν•©λ‹λ‹¤.

* **`CustomStorage` ν…ν”λ¦Ώ**: (κ³„ν μ¤‘) μ‚¬μ©μκ°€ νΉμ • μΈν”„λΌμ— λ§λ” μ¤ν† λ¦¬μ§€ μ†”λ£¨μ…μ„ μ‰½κ² κµ¬ν„ν•  μ μλ„λ΅ κ°€μ΄λ“λΌμΈκ³Ό ν…ν”λ¦Ώμ„ μ κ³µν•  μμ •μ…λ‹λ‹¤.

---
## π¤ κΈ°μ—¬ μ•λ‚΄

λ³Έ ν”„λ΅μ νΈμ— λ€ν• κΈ°μ—¬λ” μ–Έμ λ“ μ§€ ν™μν•©λ‹λ‹¤. μ΄μ λ³΄κ³ , κΈ°λ¥ μ μ•, μ½”λ“ κΈ°μ—¬ λ“± λ‹¤μ–‘ν• λ°©μ‹μΌλ΅ μ°Έμ—¬ν•μ‹¤ μ μμµλ‹λ‹¤.

---
## π“ λΌμ΄μ„ μ¤ μ •λ³΄

λ³Έ ν”„λ΅μ νΈλ” MIT λΌμ΄μ„ μ¤μ— μκ±°ν•μ—¬ λ°°ν¬λ©λ‹λ‹¤. μμ„Έν• λ‚΄μ©μ€ `LICENSE` νμΌμ„ ν†µν•΄ ν™•μΈν•μ‹¤ μ μμµλ‹λ‹¤.

---
## π“ λ¬Έμμ²

μ¶”κ°€μ μΈ λ¬Έμ μ‚¬ν•­μ΄λ‚ κ°μ„  μ μ•μ΄ μμΌμ‹¤ κ²½μ°, GitHub Issuesλ¥Ό ν†µν•΄ λ¬Έμν•μ—¬ μ£Όμ‹κΈ° λ°”λλ‹λ‹¤.
